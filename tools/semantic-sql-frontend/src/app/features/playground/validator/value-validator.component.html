<div class="container mx-auto p-6 max-w-4xl">
    <div class="mb-4">
        <h1 class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-blue-400">
            Value Validator
        </h1>
        <p class="text-gray-400">Check for hallucinations in categorical values</p>
    </div>

    <div class="bg-[#141a23] p-6 rounded-xl border border-gray-700 shadow-lg mb-6">
        <div class="grid grid-cols-2 gap-4 mb-4">
            <mat-form-field appearance="outline">
                <mat-label>Datasource Slug</mat-label>
                <input matInput [(ngModel)]="datasourceSlug" placeholder="e_commerce_db" class="text-white">
            </mat-form-field>

            <div class="flex gap-2">
                <mat-form-field appearance="outline" class="flex-1">
                    <mat-label>Table</mat-label>
                    <input matInput [(ngModel)]="targetTable" placeholder="users" class="text-white">
                </mat-form-field>

                <mat-form-field appearance="outline" class="flex-1">
                    <mat-label>Column</mat-label>
                    <input matInput [(ngModel)]="targetColumn" placeholder="country" class="text-white">
                </mat-form-field>
            </div>
        </div>

        <div class="mb-4">
            <label class="block text-xs font-semibold text-gray-400 mb-1">Proposed Values (Comma separated)</label>
            <input
                class="w-full px-4 py-3 rounded-lg border border-gray-600 bg-[#1e293b] text-gray-100 focus:ring-2 focus:ring-purple-500 outline-none placeholder-gray-500"
                [(ngModel)]="proposedValuesInput" (keyup.enter)="validate()" placeholder="e.g., USA, Italy, Germany">
        </div>

        <button mat-flat-button color="primary" class="w-full h-[48px]" (click)="validate()" [disabled]="loading">
            VALIDATE
        </button>
    </div>

    <!-- Results -->
    <div *ngIf="result" class="bg-[#141a23] p-6 rounded-xl shadow-lg border-l-8 border border-gray-700"
        [ngClass]="result.valid ? 'border-l-green-500' : 'border-l-red-500'">

        <div class="flex items-center gap-3 mb-4">
            <mat-icon [class]="result.valid ? 'text-green-400' : 'text-red-400'">
                {{result.valid ? 'check_circle' : 'error'}}
            </mat-icon>
            <h2 class="text-xl font-bold text-gray-100">
                {{result.valid ? 'Values Valid' : 'Values Invalid'}}
            </h2>
        </div>

        <div class="grid grid-cols-2 gap-8">
            <div>
                <h3 class="text-xs font-bold uppercase text-gray-400 mb-2">Mappings</h3>
                <ul class="space-y-2">
                    <li *ngFor="let item of result.mappings | keyvalue"
                        class="flex justify-between items-center bg-[#1e293b] p-2 rounded border border-gray-700">
                        <span class="text-red-400 line-through text-sm">{{item.key}}</span>
                        <span class="text-gray-400 text-xs">â†’</span>
                        <span class="text-green-400 font-mono font-bold">{{item.value}}</span>
                    </li>
                    <p *ngIf="(result.mappings | keyvalue).length === 0" class="text-gray-500 italic text-sm">No
                        mappings needed</p>
                </ul>
            </div>

            <div>
                <h3 class="text-xs font-bold uppercase text-gray-400 mb-2">Unresolved</h3>
                <ul class="space-y-2">
                    <li *ngFor="let val of result.unresolved"
                        class="bg-red-900/20 text-red-400 p-2 rounded border border-red-800 flex items-center gap-2">
                        <mat-icon class="text-sm h-4 w-4">warning</mat-icon> {{val}}
                    </li>
                    <p *ngIf="result.unresolved.length === 0" class="text-gray-500 italic text-sm">All values resolved
                    </p>
                </ul>
            </div>
        </div>
    </div>
</div>